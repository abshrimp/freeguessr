(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[540],{9138:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/End",function(){return s(5584)}])},5584:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s(4848),a=s(6540),r=s(9781),o=s.n(r);let i=e=>{let{setScreen:t,saveData:s,setSaveData:r,sender:i,getPlace:c}=e,[l,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),_=!0;(0,a.useEffect)(()=>{_&&(_=!1,p())},[]);let g=()=>{t("settings")},p=()=>{let e={1:"全国マップ",2:"デイリーマップ"};d(e[s.map_id]);let t=(e=>{let t=Math.floor(e/3600),s=Math.floor(e%3600/60),n=e%60,a;return a=t<100?"00".concat(t).slice(-2):t,0!==t?"".concat(a,"h").concat(s,"m").concat(n,"s"):"".concat(s,"m").concat(n,"s")})(s.duration);m(t),next_btn.addEventListener("click",g);let n=JSON.parse(s.game_state).questions;n[n.length-1]=s.question;let a=L.map("guess_map_canvas",{zoomControl:!1});L.tileLayer("https://www.google.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m3!1e0!2sm!3i693439125!3m12!2sja!3sJP!5e289!12m4!1e68!2m2!1sset!2sRoadmap!12m3!1e37!2m1!1ssmartmaps!4e0!5m1!5f2",{attribution:"\xa9️ <a href='https://www.google.com/maps/' target='_blank'>Google</a>",maxZoom:20,maxNativeZoom:20}).addTo(a),new ResizeObserver(()=>{a.invalidateSize()}).observe(a._container);let r=L.icon({iconUrl:"/freeguessr/images/flag.svg",iconSize:[25,50],iconAnchor:[12.5,47]}),o=L.icon({iconUrl:"/freeguessr/images/guess.svg",iconSize:[24,24],iconAnchor:[12,12]}),i=[];for(let e=0;e<n.length;e++){let t=n[e],s=L.latLng([Number(t.lat),Number(t.lng)]);if(L.marker(s,{icon:r}).addTo(a).bindPopup("Round".concat(e+1),{autoClose:!1}).openPopup(),i.push(s),t.guess_lat){let e=L.latLng([Number(t.guess_lat),Number(t.guess_lng)]);L.marker(e,{icon:o}).addTo(a),L.polyline([s,e],{color:"black",weight:2,dashArray:"4 4"}).addTo(a),i.push(e)}}a.fitBounds(L.latLngBounds(i),{padding:[30,30]}),share_btn.addEventListener("click",async()=>{let n="#FreeguessrJP\n".concat(e[s.map_id],"\n\nPoints: ").concat(s.score.toLocaleString(),"\nTime: ").concat(t,"\n\nabshrimp.github.io/freeguessr");if(navigator.share)try{await navigator.share({title:"FreeguessrJP",text:n,url:"https://abshrimp.github.io/freeguessr"})}catch(e){}else window.clipboardData?(window.clipboardData.setData("Text",n),alert("クリップボードにコピーしました")):navigator.clipboard?(navigator.clipboard.writeText(n),alert("クリップボードにコピーしました")):alert("この端末は対応していません")}),tweet_btn.addEventListener("click",()=>{let n="#FreeguessrJP\n".concat(e[s.map_id],"\n\nPoints: ").concat(s.score.toLocaleString(),"\nTime: ").concat(t,"\n\nabshrimp.github.io/freeguessr");window.open("https://twitter.com/share?text="+encodeURIComponent(n),"_blank","noopener,noreferrer")})};return(0,a.useEffect)(()=>{let e=e=>{("Enter"===e.key||" "===e.key)&&next_btn.click()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[l,u]),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:o()["guess-map"],children:(0,n.jsx)("div",{id:"guess_map_canvas",className:o()["guess-map-canvas"]})}),(0,n.jsxs)("div",{className:o().controls,children:[(0,n.jsx)("div",{className:o().round,children:(0,n.jsxs)("div",{children:[l,"　RESULT"]})}),(0,n.jsxs)("div",{className:o()["results-container"],children:[(0,n.jsx)("div",{children:u}),(0,n.jsxs)("div",{children:[(null==s?void 0:s.score.toLocaleString())||""," points"]})]}),(0,n.jsxs)("div",{className:o()["results-container"],children:[(0,n.jsx)("button",{id:"share_btn",className:o()["next-btn"],children:"共有する"}),(0,n.jsx)("button",{id:"tweet_btn",className:o()["next-btn"],children:"ツイート"}),(0,n.jsx)("button",{id:"next_btn",className:o()["next-btn"],children:"OK"})]})]})]})}},9781:e=>{e.exports={"guess-map":"result_guess-map__WxqEP","guess-map-canvas":"result_guess-map-canvas__mCAu7",controls:"result_controls__PeGYl","results-container":"result_results-container__FlTml",round:"result_round__Sm0e2","next-btn":"result_next-btn__VLj7M",loading:"result_loading__xfA6c",loadingIcon:"result_loadingIcon__tnSEj",spin:"result_spin__WS2lf"}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(9138)),_N_E=e.O()}]);