(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[275],{4892:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/daily",function(){return a(7931)}])},7931:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(4848),n=a(6540),r=a(8133),l=a.n(r),o=a(6791),i=a(5114);let c=()=>{let[e,t]=(0,n.useState)("play"),a={setScreen:e=>{t(e)},saveData:{daily:!0,move_count:0,question:{pano_id:"",heading:0,stage:0,lat:"",lng:""},game_type:0,stage_num:0,limit_time:0,map_id:2,score:0},setSaveData:()=>{},sender:async()=>{},getPlace:async()=>{try{let e=await fetch("https://abshrimp.cloudfree.jp/geo/daily.php");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(e){return console.error("Error:",e),alert("エラーが発生しました\nもう一度お試しください"),location.reload(),null}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{src:"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",strategy:"afterInteractive"}),(0,s.jsx)("div",{children:(()=>{switch(e){case"play":default:return(0,s.jsx)(o.default,{...a});case"result":return(0,s.jsx)(i.default,{...a})}})()})]})}},5114:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(4848),n=a(6540),r=a(9781),l=a.n(r);let o=e=>{let{setScreen:t,saveData:a,setSaveData:r,sender:o,getPlace:i}=e,[c,d]=(0,n.useState)(""),[u,g]=(0,n.useState)(""),[m,_]=(0,n.useState)(""),h=!0;(0,n.useEffect)(()=>{h&&(h=!1,p())},[]);let p=()=>{let e={stage:localStorage.getItem("stage"),lat:localStorage.getItem("lat"),lng:localStorage.getItem("lng"),guess_lat:localStorage.getItem("guess_lat"),guess_lng:localStorage.getItem("guess_lng"),move_count:localStorage.getItem("move_count")};d(e.stage);let t=L.map("guess_map_canvas",{zoomControl:!1});L.tileLayer("https://www.google.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m3!1e0!2sm!3i693439125!3m12!2sja!3sJP!5e289!12m4!1e68!2m2!1sset!2sRoadmap!12m3!1e37!2m1!1ssmartmaps!4e0!5m1!5f2",{attribution:"\xa9️ <a href='https://www.google.com/maps/' target='_blank'>Google</a>",maxZoom:20,maxNativeZoom:20}).addTo(t),new ResizeObserver(()=>{t.invalidateSize()}).observe(t._container);let a=L.latLng([Number(e.lat),Number(e.lng)]),s=-1,n=0;if(e.guess_lat){let r=L.icon({iconUrl:"/freeguessr/images/guess.svg",iconSize:[24,24],iconAnchor:[12,12]}),l=L.marker([Number(e.guess_lat),Number(e.guess_lng)],{icon:r}).addTo(t);L.polyline([a,l.getLatLng()],{color:"black",weight:2,dashArray:"4 4"}).addTo(t),t.fitBounds(L.latLngBounds([a,l.getLatLng()]),{padding:[30,30]}),n=Math.round(5e3*Math.exp(-((s=a.distanceTo(l.getLatLng()))/1e3)/212.856))}else t.setView([a.lat,a.lng],10);t.invalidateSize();let r=L.icon({iconUrl:"/freeguessr/images/flag.svg",iconSize:[25,50],iconAnchor:[12.5,47]});L.marker(a,{icon:r}).addTo(t);let l="";s>=0&&(l=s<1e3?Math.round(s).toLocaleString()+" m":s<1e4?(Math.round(s/100)/10).toLocaleString()+" km":Math.round(s/1e3).toLocaleString()+" km"),g(l);let o=n.toLocaleString();_(o+=1==n?" point":" points"),next_btn.addEventListener("click",()=>{location.href="/freeguessr"});let i="#FreeguessrJP\nDay".concat(e.stage,"\n\nDistance: ").concat(l,"\nPoints: ").concat(n.toLocaleString(),"\nMove: ").concat(e.move_count,"\n\nabshrimp.github.io/freeguessr/daily");share_btn.addEventListener("click",async()=>{if(navigator.share)try{await navigator.share({title:"FreeguessrJP",text:i,url:"https://abshrimp.github.io/freeguessr/daily"})}catch(e){}else window.clipboardData?(window.clipboardData.setData("Text",i),alert("クリップボードにコピーしました")):navigator.clipboard?(navigator.clipboard.writeText(i),alert("クリップボードにコピーしました")):alert("この端末は対応していません")}),tweet_btn.addEventListener("click",()=>{window.open("https://twitter.com/share?text="+encodeURIComponent(i),"_blank","noopener,noreferrer")})};return(0,n.useEffect)(()=>{let e=e=>{("Enter"===e.key||" "===e.key)&&"undefined"!=typeof next_btn&&next_btn.click()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[c,u,m]),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:l()["guess-map"],children:(0,s.jsx)("div",{id:"guess_map_canvas",className:l()["guess-map-canvas"]})}),(0,s.jsxs)("div",{className:l().controls,children:[(0,s.jsx)("div",{className:l().round,children:(0,s.jsxs)("div",{children:["Day ",c]})}),(0,s.jsxs)("div",{className:l()["results-container"],children:[(0,s.jsx)("div",{children:u}),(0,s.jsx)("div",{children:m})]}),(0,s.jsxs)("div",{className:l()["results-container"],children:[(0,s.jsx)("button",{id:"share_btn",className:l()["next-btn"],children:"共有する"}),(0,s.jsx)("button",{id:"tweet_btn",className:l()["next-btn"],children:"ツイート"}),(0,s.jsx)("button",{id:"next_btn",className:l()["next-btn"],children:"ホームへ"})]})]})]})}},9781:e=>{e.exports={"guess-map":"result_guess-map__WxqEP","guess-map-canvas":"result_guess-map-canvas__mCAu7",controls:"result_controls__PeGYl","results-container":"result_results-container__FlTml",round:"result_round__Sm0e2","next-btn":"result_next-btn__VLj7M",loading:"result_loading__xfA6c",loadingIcon:"result_loadingIcon__tnSEj",spin:"result_spin__WS2lf"}}},e=>{var t=t=>e(e.s=t);e.O(0,[965,791,636,593,792],()=>t(4892)),_N_E=e.O()}]);